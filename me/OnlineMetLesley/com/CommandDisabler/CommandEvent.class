package me.OnlineMetLesley.com.CommandDisabler;

import java.text.SimpleDateFormat;
import java.util.Calendar;
import java.util.Iterator;
import org.bukkit.ChatColor;
import org.bukkit.Effect;
import org.bukkit.Sound;
import org.bukkit.entity.Player;
import org.bukkit.event.EventHandler;
import org.bukkit.event.Listener;
import org.bukkit.event.player.PlayerCommandPreprocessEvent;
import org.bukkit.plugin.Plugin;

public class CommandEvent implements Listener {
   public Plugin instance;

   public void function() {
      Main plugin = (Main)Main.instance;
      plugin.getServer();
   }

   public String getTime() {
      Calendar cal = Calendar.getInstance();
      SimpleDateFormat sdf = new SimpleDateFormat("yyyy-MM-dd HH:mm:ss");
      return sdf.format(cal.getTime());
   }

   @EventHandler
   public void onCommandPlugins(PlayerCommandPreprocessEvent event) {
      Player player = event.getPlayer();
      Iterator var4 = Main.instance.getConfig().getStringList("commands.commands").iterator();

      while(var4.hasNext()) {
         String command = (String)var4.next();
         if (event.getMessage().toLowerCase().startsWith("/" + command)) {
            if (Main.instance.getConfig().getBoolean("commands.AllowPlayers")) {
               event.setCancelled(true);
               player.sendMessage(ChatColor.translateAlternateColorCodes('&', Main.instance.getConfig().getString("commands.BlockMessage")));
               if (Main.instance.getConfig().getBoolean("commands.Sounds")) {
                  player.playSound(player.getLocation(), Sound.valueOf(Main.instance.getConfig().getString("commands.Sound").toUpperCase()), 10.0F, 100.0F);
               }

               if (Main.instance.getConfig().getBoolean("commands.Particles")) {
                  player.spigot().playEffect(player.getLocation(), Effect.valueOf(Main.instance.getConfig().getString("commands.Particle").toUpperCase()), 0, 0, 0.0F, 0.0F, 0.0F, 0.0F, 5, 30);
               }
            } else {
               player.sendMessage(ChatColor.translateAlternateColorCodes('&', Main.instance.getConfig().getString("commands.BlockMessage")));
            }
         }
      }

   }
}
